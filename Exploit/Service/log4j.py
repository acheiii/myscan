# coding=utf-8

# 4300

# CVE-2019-17571
from exploit.service.base import *


# log4j 反序列化
async def log4jScan(addr, pbar):
    vulList = []

    try:
        s = socket.socket()
        s.connect((addr.split(':')[0], int(addr.split(':')[1])))
        s.send(b"stats")
        result = s.recv(1024)
        if b"STAT version" in result:
            vulList.append({'name': 'deserialization', 'url': addr, 'software': 'log4j'})
    except:
        pass
    finally:
        try:
            writer.close()
        except NameError:
            pass
    return vulList