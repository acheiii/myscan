# coding=utf-8
from exploit.public import *


# base Exploit class
class BaseExploit(metaclass=ABCMeta):
    __slots__ = ('source', 'headers', 'reqTimeout', 'domain', 'resList')

    def __init__(self):
        self.source = 'BaseExploit'  #
        self.headers = {
            'Accept': 'text/html,application/xhtml+xml,'
                      'application/xml;q=0.9,*/*;q=0.8',
            'Accept-Encoding': 'gzip, deflate',
            'Accept-Language': 'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7',
            'Cache-Control': 'max-age=0',
            'DNT': '1',
            'Referer': 'https://www.google.com/',
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 '
                          '(KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36',
            'Upgrade-Insecure-Requests': '1',
            'X-Forwarded-For': '127.0.0.1',
        }
        self.reqTimeout = 10
        self.resList = []

    @abstractmethod
    def exploit(self):
        pass

    def writeFile(self, web_lists, page):
        workbook = openpyxl.load_workbook(abs_path + str(self.domain) + ".xlsx")
        worksheet = workbook.worksheets[page]
        index = 0
        while index < len(web_lists):
            web = list()
            # for _ in web_lists.items():
            #     web.append(web_lists[index][0])
            #     web.append(web_lists[index][0])
            #     web.append(web_lists[index][0])
            web.append(web_lists[index]['name'])
            web.append(web_lists[index]['url'])
            web.append(web_lists[index]['software'])
            worksheet.append(web)
            index += 1
        workbook.save(abs_path + str(self.domain) + ".xlsx")
        workbook.close()

    @abstractmethod
    def main(self):
        pass
