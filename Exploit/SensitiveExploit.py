# coding=utf-8

from Exploit.BaseExploit import *
import requests
from Exploit.Common import rules

class SensitiveScan(Exploit):
    def __init__(self, domain, http):
        super().__init__()
        self.headers = {'User-Agent': "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/22.0.1207.1 Safari/537.1"}
        self.domain = domain
        self._http = http.replace('\n', '') if http.startswith('http') else 'http://' + http.replace('\n', '')
        self.result = list()
        self.folders = list()

    def folder_init(self):
        pass

    def write_file(self, web_lists, target, page):
        pass

    def exploit(self):
        _folders = self.folders.split()
        for _path in _folders:
            resp = requests.get(url=self._http + _path, headers=self.headers)
            if resp.status_code == 200:
                self.result.append(_path)

    def main(self):
        self.exploit()
        self.write_file(self.result, self.domain, 9)


