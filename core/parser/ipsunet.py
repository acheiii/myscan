# coding=utf-8
# @Author   : zpchcbd HG team
# @blog     : https://www.cnblogs.com/zpchcbd/
# @Time     : 2021-11-26 15:46

"""
write in 2021.11.26 15.46 @zpchcbd

实现的目的：
1、filterCDN方法添加(为后面的portscan模块节省时间，如果的cdn网段的ip进行端口扫描的话是无意义的)
"""


def ipToBinary(ip):
    ip_num = ip.split('.')
    x = 0

    """
    IP地址是点分十进制，例如：192.168.1.33，共32bit
    第1节（192）向前移24位，第2节（168）向前移16位
    第3节（1）向迁移8位，第4节（33）不动
    然后进行或运算，得出数据
    """
    for i in range(len(ip_num)):
        num = int(ip_num[i]) << (24 - i * 8)
        x = x | num

    binaryStr = str(bin(x).replace('0b', ''))
    return binaryStr


def maskToBinary(mask):
    """
    两种情况的处理
    1、/24
    2、255.255.255.0
    """
    mask_list = str(mask).split('.')

    # 子网掩码有两种表现形式，例如：/24或255.255.255.0
    if len(mask_list) == 1:
        # 生成一个32个元素均是0的列表
        binary32 = []
        for i in range(32):
            binary32.append('0')

        # 多少位子网掩码就是连续多少个1
        for i in range(int(mask)):
            binary32[i] = '1'

        binary = ''.join(binary32)

    # 输入的子网掩码是255.255.255.0这种点分十进制格式
    elif len(mask_list) == 4:
        binary = ipToBinary(mask)

    return binary


# 判断IP地址是否属于这个网段
def ipInSubnet(ip, subnet):
    try:
        subnet_list = subnet.split('/')
        networt_add = subnet_list[0]
        network_mask = subnet_list[1]

        # 原来的得出的二进制数据类型是str，转换数据类型
        ip_num = int(ipToBinary(ip), 2)
        subnet_num = int(ipToBinary(networt_add), 2)
        mask_bin = int(maskToBinary(network_mask), 2)

        # IP和掩码与运算后比较
        if (ip_num & mask_bin) == (subnet_num & mask_bin):
            return True
        else:
            return False
    except Exception:
        return False


FILTER_CDN_IPSEGMENT_LIST = [
    '223.99.255.0/24', '71.152.0.0/17', '219.153.73.0/24', '125.39.46.0/24', '190.93.240.0/20', '14.0.113.0/24',
    '14.0.47.0/24', '113.20.148.0/22', '103.75.201.0/24', '1.32.239.0/24', '101.79.239.0/24', '52.46.0.0/18',
    '125.88.189.0/24', '150.138.248.0/24', '180.153.235.0/24', '205.251.252.0/23', '103.1.65.0/24', '115.127.227.0/24',
    '14.0.42.0/24', '109.199.58.0/24', '116.211.155.0/24', '112.253.3.0/24', '14.0.58.0/24', '223.112.227.0/24',
    '113.20.150.0/23', '61.182.141.0/24', '34.216.51.0/25', '124.95.188.0/24', '42.51.25.0/24', '183.136.133.0/24',
    '52.220.191.0/26', '119.84.93.0/24', '182.118.38.0/24', '13.59.250.0/26', '54.178.75.0/24', '119.84.92.0/24',
    '183.131.62.0/24', '111.32.136.0/24', '13.124.199.0/24', '111.47.227.0/24', '104.37.177.0/24', '14.0.50.0/24',
    '183.230.70.0/24', '114.111.59.0/24', '220.181.135.0/24', '112.140.32.0/19', '101.79.230.0/24', '14.0.115.0/24',
    '103.28.248.0/22', '117.34.72.0/24', '109.199.57.0/24', '101.79.149.0/24', '116.128.128.0/24', '115.231.186.0/24',
    '103.22.200.0/22', '61.155.165.0/24', '113.20.148.0/23', '185.254.242.0/24', '59.36.120.0/24', '70.132.0.0/18',
    '116.31.126.0/24', '119.147.134.0/24', '115.127.246.0/24', '52.47.139.0/24', '118.107.175.0/24', '52.78.247.128/26',
    '110.93.176.0/20', '54.240.128.0/18', '46.51.216.0/21', '119.31.251.0/24', '125.39.18.0/24', '108.175.33.0/24',
    '1.31.128.0/24', '61.151.163.0/24', '103.95.132.0/24', '58.215.118.0/24', '54.233.255.128/26', '120.52.113.0/24',
    '118.107.174.0/24', '1.32.242.0/24', '221.195.34.0/24', '101.79.228.0/24', '205.251.249.0/24', '113.200.91.0/24',
    '101.79.146.0/24', '221.238.22.0/24', '134.19.183.0/24', '110.93.160.0/20', '180.97.158.0/24', '115.127.251.0/24',
    '119.167.147.0/24', '115.127.238.0/24', '115.127.240.0/22', '14.0.48.0/24', '115.127.240.0/24', '113.7.183.0/24',
    '112.140.128.0/20', '115.127.255.0/24', '114.31.36.0/22', '101.79.232.0/24', '218.98.44.0/24', '106.119.182.0/24',
    '101.79.167.0/24', '125.39.5.0/24', '58.49.105.0/24', '124.202.164.0/24', '111.177.6.0/24', '61.133.127.0/24',
    '185.11.124.0/22', '150.138.150.0/24', '115.127.248.0/24', '103.74.80.0/22', '101.79.166.0/24', '101.71.55.0/24',
    '198.41.128.0/17', '117.21.219.0/24', '103.231.170.0/24', '221.204.202.0/24', '101.79.224.0/24', '112.25.16.0/24',
    '111.177.3.0/24', '204.246.168.0/22', '103.40.7.0/24', '134.226.0.0/16', '52.15.127.128/26', '122.190.2.0/24',
    '101.203.192.0/18', '1.32.238.0/24', '101.79.144.0/24', '176.34.28.0/24', '119.84.15.0/24', '18.216.170.128/25',
    '222.88.94.0/24', '101.79.150.0/24', '114.111.48.0/21', '124.95.168.0/24', '114.111.48.0/20', '110.93.176.0/21',
    '223.111.127.0/24', '117.23.61.0/24', '140.207.120.0/24', '157.255.26.0/24', '221.204.14.0/24', '183.222.96.0/24',
    '104.37.180.0/24', '42.236.93.0/24', '111.63.51.0/24', '114.31.32.0/20', '118.180.50.0/24', '222.240.184.0/24',
    '205.251.192.0/19', '101.79.225.0/24', '115.127.228.0/24', '113.20.148.0/24', '61.213.176.0/24', '112.65.75.0/24',
    '111.13.147.0/24', '113.20.145.0/24', '103.253.132.0/24', '52.222.128.0/17', '183.203.7.0/24', '27.221.27.0/24',
    '103.79.134.0/24', '123.150.187.0/24', '103.15.194.0/24', '162.158.0.0/15', '61.163.30.0/24', '182.140.227.0/24',
    '112.25.60.0/24', '117.148.161.0/24', '61.182.136.0/24', '114.31.56.0/22', '64.252.128.0/18', '183.61.185.0/24',
    '115.127.250.0/24', '150.138.138.0/24', '13.210.67.128/26', '211.162.64.0/24', '61.174.9.0/24', '14.0.112.0/24',
    '52.52.191.128/26', '27.221.124.0/24', '103.4.203.0/24', '103.14.10.0/24', '34.232.163.208/29', '114.31.48.0/20',
    '59.51.81.0/24', '183.60.235.0/24', '101.227.206.0/24', '125.39.174.0/24', '119.167.246.0/24', '118.107.160.0/21',
    '223.166.151.0/24', '110.93.160.0/19', '204.246.172.0/23', '119.31.253.0/24', '143.204.0.0/16', '14.0.60.0/24',
    '123.151.76.0/24', '116.193.80.0/24', '120.241.102.0/24', '180.96.20.0/24', '216.137.32.0/19', '223.94.95.0/24',
    '103.4.201.0/24', '14.0.56.0/24', '115.127.234.0/24', '113.20.144.0/23', '103.248.104.0/24', '122.143.15.0/24',
    '101.79.229.0/24', '101.79.163.0/24', '104.37.112.0/22', '115.127.253.0/24', '141.101.64.0/18', '113.20.144.0/22',
    '101.79.155.0/24', '117.148.160.0/24', '124.193.166.0/24', '109.94.168.0/24', '203.90.247.0/24', '101.79.208.0/21',
    '182.118.12.0/24', '114.31.58.0/23', '202.162.109.0/24', '101.79.164.0/24', '58.216.2.0/24', '222.216.190.0/24',
    '101.79.165.0/24', '111.6.191.0/24', '1.255.100.0/24', '52.84.0.0/15', '112.65.74.0/24', '183.250.179.0/24',
    '101.79.236.0/24', '119.31.252.0/24', '113.20.150.0/24', '60.12.166.0/24', '101.79.234.0/24', '113.17.174.0/24',
    '101.79.237.0/24', '61.54.46.0/24', '118.212.233.0/24', '183.110.242.0/24', '150.138.149.0/24', '117.34.13.0/24',
    '115.127.245.0/24', '14.0.102.0/24', '14.0.109.0/24', '61.130.28.0/24', '113.20.151.0/24', '219.159.84.0/24',
    '114.111.62.0/24', '172.64.0.0/13', '61.155.222.0/24', '120.52.29.0/24', '115.127.231.0/24', '14.0.49.0/24',
    '113.202.0.0/16', '103.248.104.0/22', '205.251.250.0/23', '103.216.136.0/22', '118.107.160.0/20', '109.87.0.0/21',
    '54.239.128.0/18', '115.127.224.0/19', '111.202.98.0/24', '109.94.169.0/24', '59.38.112.0/24', '204.246.176.0/20',
    '123.133.84.0/24', '103.4.200.0/24', '111.161.109.0/24', '112.84.34.0/24', '103.82.129.0/24', '183.3.254.0/24',
    '112.137.184.0/21', '122.227.237.0/24', '36.42.75.0/24', '13.35.0.0/16', '101.226.4.0/24', '116.140.35.0/24',
    '58.250.143.0/24', '13.54.63.128/26', '205.251.254.0/24', '173.245.48.0/20', '183.61.177.0/24', '113.20.144.0/24',
    '104.37.183.0/24', '35.158.136.0/24', '116.211.121.0/24', '42.236.94.0/24', '117.34.91.0/24', '123.6.13.0/24',
    '13.224.0.0/14', '113.20.146.0/24', '58.58.81.0/24', '52.124.128.0/17', '122.228.198.0/24', '197.234.240.0/22',
    '99.86.0.0/16', '144.220.0.0/16', '119.188.97.0/24', '36.27.212.0/24', '104.37.178.0/24', '114.31.52.0/22',
    '218.65.212.0/24', '1.255.41.0/24', '14.0.45.0/24', '1.32.243.0/24', '220.170.185.0/24', '122.190.3.0/24',
    '103.79.133.0/24', '220.181.55.0/24', '125.39.191.0/24', '115.127.226.0/24', '125.39.32.0/24', '61.120.154.0/24',
    '103.4.202.0/24', '103.79.134.0/23', '115.127.224.0/24', '113.20.147.0/24', '61.156.149.0/24', '210.209.122.0/24',
    '115.127.249.0/24', '104.37.179.0/24', '120.52.18.0/24', '54.192.0.0/16', '14.0.55.0/24', '61.160.224.0/24',
    '113.207.101.0/24', '101.79.157.0/24', '110.93.128.0/20', '58.251.121.0/24', '61.240.149.0/24', '130.176.0.0/16',
    '113.107.238.0/24', '112.65.73.0/24', '103.75.200.0/23', '199.83.128.0/21', '123.129.220.0/24', '54.230.0.0/16',
    '114.111.60.0/24', '199.27.128.0/21', '14.0.118.0/24', '101.79.158.0/24', '119.31.248.0/21', '54.182.0.0/16',
    '113.31.27.0/24', '14.17.69.0/24', '101.79.145.0/24', '113.20.144.0/21', '180.163.22.0/24', '104.37.176.0/21',
    '117.25.156.0/24', '115.127.252.0/24', '115.127.244.0/23', '14.0.46.0/24', '113.207.102.0/24', '52.199.127.192/26',
    '13.113.203.0/24', '64.252.64.0/18', '1.32.240.0/24', '123.129.232.0/24', '1.32.241.0/24', '180.163.189.0/24',
    '157.255.25.0/24', '1.32.244.0/24', '103.248.106.0/24', '121.48.95.0/24', '54.239.192.0/19', '113.20.146.0/23',
    '61.136.173.0/24', '35.162.63.192/26', '117.34.14.0/24', '183.232.29.0/24', '42.81.93.0/24', '122.228.238.0/24',
    '183.61.190.0/24', '125.39.239.0/24', '115.127.230.0/24', '103.140.200.0/23', '202.102.85.0/24', '14.0.32.0/21',
    '14.0.57.0/24', '112.25.90.0/24', '58.211.137.0/24', '210.22.63.0/24', '34.226.14.0/24', '13.32.0.0/15',
    '101.79.156.0/24', '103.89.176.0/24', '14.0.116.0/24', '106.42.25.0/24', '101.79.233.0/24', '101.79.231.0/24',
    '103.75.200.0/24', '119.188.9.0/24', '183.232.51.0/24', '149.126.72.0/21', '103.21.244.0/22', '115.127.233.0/24',
    '27.221.20.0/24', '198.143.32.0/19', '103.248.107.0/24', '101.79.227.0/24', '115.127.242.0/24', '119.31.250.0/24',
    '103.82.130.0/24', '99.84.0.0/16', '222.73.144.0/24', '103.79.132.0/22', '101.79.208.0/20', '104.37.182.0/24',
    '101.79.152.0/24', '36.99.18.0/24', '101.71.56.0/24', '36.250.5.0/24', '61.158.240.0/24', '119.188.14.0/24',
    '13.249.0.0/16', '183.214.156.0/24', '60.221.236.0/24', '58.30.212.0/24', '115.127.254.0/24', '188.114.96.0/20',
    '115.127.241.0/24', '103.4.200.0/22', '115.127.239.0/24', '115.127.243.0/24', '111.32.135.0/24', '120.221.29.0/24',
    '115.127.232.0/24', '14.0.43.0/24', '14.0.59.0/24', '183.61.236.0/24', '34.223.12.224/27', '103.24.120.0/24',
    '52.57.254.0/24', '113.207.100.0/24', '222.186.19.0/24', '113.20.149.0/24', '150.138.151.0/24', '115.231.110.0/24',
    '52.56.127.0/25', '104.37.176.0/24', '163.177.8.0/24', '163.53.89.0/24', '52.82.128.0/19', '114.111.63.0/24',
    '108.162.192.0/18', '14.136.130.0/24', '115.127.229.0/24', '14.17.71.0/24', '52.212.248.0/26', '180.163.188.0/24',
    '61.182.137.0/24', '119.161.224.0/21', '14.0.41.0/24', '202.162.108.0/24', '106.122.248.0/24', '52.66.194.128/26',
    '115.127.237.0/24', '220.170.186.0/24', '14.0.32.0/19', '14.0.114.0/24', '112.90.216.0/24', '115.127.236.0/24',
    '116.193.84.0/24', '113.207.76.0/24', '101.79.235.0/24', '101.79.224.0/20', '61.155.149.0/24', '101.79.148.0/24',
    '180.163.224.0/24', '204.246.174.0/23', '183.60.136.0/24', '101.227.207.0/24', '103.248.105.0/24',
    '119.188.35.0/24', '42.236.7.0/24', '116.193.88.0/21', '116.193.83.0/24', '120.199.69.0/24', '122.226.182.0/24',
    '58.20.204.0/24', '110.93.128.0/21', '115.231.187.0/24', '69.28.58.0/24', '114.31.32.0/19', '112.25.91.0/24',
    '59.52.28.0/24', '117.27.149.0/24', '61.147.92.0/24', '14.0.117.0/24', '14.0.40.0/24', '119.97.151.0/24',
    '103.199.228.0/22', '122.70.134.0/24', '115.127.244.0/24', '223.112.198.0/24', '115.127.225.0/24', '104.16.0.0/12',
    '121.12.98.0/24', '103.31.4.0/22', '204.246.164.0/22', '223.94.66.0/24', '35.167.191.128/26', '116.31.127.0/24',
    '101.79.226.0/24', '34.195.252.0/24', '115.127.247.0/24', '61.240.144.0/24', '108.175.32.0/20', '120.197.85.0/24',
    '183.232.53.0/24', '111.161.66.0/24', '117.34.28.0/24', '45.64.64.0/22', '14.0.44.0/24', '109.86.0.0/15',
    '182.23.211.0/24', '58.211.2.0/24', '119.36.164.0/24', '116.55.250.0/24', '101.227.163.0/24', '13.228.69.0/24',
    '120.221.136.0/24', '119.188.132.0/24', '115.127.235.0/24', '42.236.6.0/24', '125.88.190.0/24', '61.54.47.0/24',
    '103.27.12.0/22', '116.193.80.0/21', '101.79.159.0/24', '123.155.158.0/24', '111.47.226.0/24', '131.0.72.0/22',
    '192.230.64.0/18', '218.92.0.0/24'
]


# ip段识别
def getIpSegment(ipList: list):
    ll = []
    for l in ipList:
        l = l.split(".")
        l[-1] = "0/24"
        joinl = ".".join(l)
        if joinl not in ll:
            ll.append(joinl)
    return ll


def test(ipList, ipSegmentList):
    filterIpList = []
    for ip in ipList:
        flag = True
        for ipSegment in FILTER_CDN_IPSEGMENT_LIST:
            if ipInSubnet(ip, ipSegment):
                flag = False
                break
        if flag:
            filterIpList.append(ip)
    tempIpSegmentList = getIpSegment(filterIpList)
    for ipSegment in tempIpSegmentList:
        ipSegmentList.append({'ipSegment': ipSegment, 'ip': [], 'num': 0})

    for ip in filterIpList:
        for index, ipSegment in enumerate(ipSegmentList):
            if ipInSubnet(ip, ipSegment['ipSegment']):
                ipSegmentList[index]['num'] += 1
                ipSegmentList[index]['ip'].append(ip)


if __name__ == '__main__':
    ipList = ['1.31.128.238', '2408:863c:861:1::200', '120.79.208.87', '121.37.218.76', '119.23.85.136', '120.77.164.50', '124.238.245.99',
              '47.106.47.204', '8.129.38.45', '47.112.97.182', '221.194.147.203', '116.11.123.228', '47.106.228.201',
              '47.115.134.113', '120.79.200.254', '8.129.6.249', '39.108.64.221', '47.107.54.234', '119.23.93.160',
              '13.228.45.83', '120.25.135.144', '47.106.61.39', '47.113.58.123', '120.77.170.48', '47.112.186.118',
              '129.226.173.97', '47.106.29.219', '47.106.89.191', '47.115.177.198', '120.25.134.91', '139.9.194.147',
              '47.115.137.178', '106.117.214.216', '218.17.244.226', '47.113.22.155', '47.107.222.101',
              '47.115.126.210',
              '47.107.27.50', '61.182.131.239', '47.106.129.205', '120.24.160.195', '47.115.116.181', '13.251.199.0',
              '121.37.237.55', '8.135.21.84', '47.107.233.45', '117.184.254.47', '47.106.60.183', '86.183.48.255',
              '3.0.179.84',
              '47.106.214.253', '47.106.17.143', '121.9.203.231', '47.106.192.31', '139.9.80.134', '120.25.230.240',
              '125.77.171.112', '47.107.22.235', '123.6.12.234', '47.113.23.251', '116.211.155.211', '166.104.100.206',
              '120.24.212.176', '1.180.12.239', '47.106.238.174', '120.77.198.59', '119.23.92.178', '18.228.151.64',
              '120.77.199.33', '47.107.62.123', '120.77.133.170', '112.74.72.79', '47.112.252.117', '61.240.142.53',
              '120.78.143.194', '120.24.78.30', '119.23.93.107', '47.115.166.121', '27.19.248.240', '47.112.246.89',
              '120.24.97.114', '47.107.218.50', '54.251.14.55', '47.113.23.246', '120.24.40.126', '35.154.239.204',
              '104.18.26.205', '120.76.119.127', '113.96.63.218', '47.113.57.1', '119.167.179.238', '120.78.190.38',
              '140.207.195.74', '13.228.74.14', '120.78.17.200', '47.107.38.25', '120.77.198.197', '39.108.127.243',
              '3.108.160.119', '36.249.66.102', '47.106.128.70', '8.129.37.220', '120.24.83.35', '106.117.214.215',
              '49.7.22.213', '124.71.102.252', '180.163.122.226', '8.129.102.210', '47.107.23.177', '177.71.248.216',
              '27.221.119.235', '47.106.60.72', '120.77.112.153', '120.78.165.41', '36.102.11.236', '157.255.170.196',
              '47.115.152.216', '139.159.179.229', '47.107.23.146', '52.220.84.175', '120.77.229.250', '18.229.0.166',
              '47.106.46.90', '124.239.158.230', '120.79.60.196', '180.163.122.225', '120.24.144.174',
              '119.167.188.230',
              '47.106.253.12', '47.106.167.116', '120.78.203.39', '47.115.92.168', '112.90.216.68', '47.107.192.74',
              '124.71.215.205', '150.138.39.242', '218.17.244.230', '119.23.49.222', '39.108.40.89', '52.76.60.211',
              '153.3.235.96', '8.129.31.229', '8.135.38.214', '120.78.204.153', '120.77.112.118', '60.9.0.248',
              '120.78.177.241',
              '47.115.114.41', '163.181.33.227', '47.106.15.190', '119.23.83.173', '54.254.48.44', '139.159.148.210',
              '47.106.148.107', '120.77.199.231', '8.129.34.186', '36.249.67.79', '120.25.223.87', '39.108.63.216',
              '47.246.4.225', '47.107.19.197', '47.115.169.67', '13.235.207.106', '8.129.19.103', '47.115.58.118',
              '47.107.99.201', '120.77.146.31', '47.107.222.204', '8.129.111.96', '120.78.164.251', '47.107.215.232',
              '47.115.148.81', '111.225.210.240', '120.76.119.228', '47.107.22.72', '8.129.74.97', '47.106.248.41',
              '120.79.146.198', '47.106.66.55', '101.226.27.236', '120.77.166.132', '124.71.12.68', '139.227.230.30',
              '120.24.233.154', '139.9.43.73', '58.241.27.248', '124.71.34.51', '112.74.105.191', '120.24.188.111',
              '47.106.215.228', '139.227.230.118', '120.78.171.158', '36.248.25.117', '47.115.81.215', '121.37.232.159',
              '120.24.195.22', '47.112.115.71', '139.159.217.65', '47.106.73.94', '120.79.139.128', '180.163.149.238',
              '47.106.60.197', '119.23.84.243', '139.9.38.109', '47.107.218.126', '112.90.216.113', '47.107.23.144',
              '139.9.208.212', '120.78.187.124', '36.249.76.239', '36.249.66.104', '120.78.212.92', '112.74.112.107',
              '120.77.111.21', '52.74.13.87', '47.113.59.67', '49.7.22.217', '36.249.67.103', '36.249.67.99',
              '119.23.50.229',
              '139.159.250.80', '120.39.197.242', '120.24.93.230', '27.128.221.242', '47.107.15.161', '117.23.61.211',
              '39.108.39.172', '120.25.230.128', '8.129.135.39', '140.249.88.203', '13.229.190.243', '47.106.93.53',
              '104.18.27.205', '112.74.61.115', '47.115.37.153', '120.24.43.30', '119.23.84.248', '47.106.27.96',
              '120.77.228.109', '120.78.168.153', '47.113.23.243', '54.169.242.66', '18.231.42.176', '120.77.164.228',
              '36.102.11.248', '157.255.170.230', '119.167.191.211', '39.108.230.119', '163.181.37.228', '39.108.38.81',
              '124.71.5.89', '1.31.128.252', '47.119.127.12', '212.64.63.66', '47.115.164.61', '120.25.195.208',
              '13.127.105.225', '8.129.4.36', '47.107.18.213', '120.77.198.4', '47.113.21.90', '117.48.233.10',
              '119.167.188.226', '120.24.53.125', '120.76.217.197', '116.11.123.226', '39.108.93.184', '47.115.75.77',
              '65.0.52.13', '150.138.39.240', '47.115.144.185', '3.7.112.238', '120.79.99.127', '52.67.139.120',
              '47.106.156.164', '60.9.0.243', '47.107.20.166', '180.163.149.248', '120.77.199.255', '139.9.188.217',
              '139.227.230.112', '120.77.143.49', '120.76.118.32', '121.37.242.209', '47.115.137.169',
              '139.159.238.183',
              '81.69.157.69', '119.167.179.241', '47.106.244.98', '120.79.155.49', '47.106.112.132', '112.74.93.55',
              '47.113.57.175', '120.78.185.236', '112.132.33.237', '120.79.175.220', '18.229.247.103', '119.23.149.241',
              '8.129.31.175', '36.248.210.101', '47.115.151.10', '112.85.251.227', '120.24.215.175', '106.117.214.220',
              '120.77.228.178', '120.77.164.249', '139.9.71.114', '47.107.193.242', '153.3.137.220', '8.129.31.60',
              '124.239.158.233', '47.119.129.130', '3.7.188.179', '18.231.58.245', '120.77.110.203', '111.202.98.85',
              '120.77.169.112', '47.107.19.237', '47.107.20.205', '120.25.125.109', '61.168.100.97', '13.228.122.59',
              '120.78.181.246', '118.212.233.160', '120.25.101.48', '120.25.250.247', '36.249.66.103', '119.23.87.38',
              '47.115.123.250', '47.106.45.251', '47.112.178.185', '47.113.59.93', '47.107.95.215', '3.6.196.207',
              '1.180.12.240', '139.9.221.206', '121.37.19.81', '121.37.218.27', '120.79.158.175', '47.106.97.231',
              '36.248.210.83', '120.79.138.141', '113.229.252.117', '120.76.64.230', '47.106.76.137', '47.113.24.88',
              '120.79.44.250', '120.77.198.168', '47.112.100.205', '36.249.67.98', '27.221.119.231', '47.106.162.159',
              '120.24.144.20', '125.36.180.240', '47.106.122.231', '120.77.42.42', '106.117.214.217', '120.76.57.167',
              '47.112.230.81', '47.112.133.166', '47.115.75.111', '47.107.217.77', '120.79.183.209', '120.77.204.106',
              '112.85.251.231', '221.207.101.80', '120.25.222.92', '1.31.128.240', '47.106.69.29', '47.113.59.167',
              '47.113.57.250', '118.31.64.167', '47.113.53.153', '3.0.53.130', '112.74.101.189', '47.106.45.156',
              '120.78.187.30', '1.180.12.248', '120.78.76.204', '47.115.174.3', '47.106.225.233', '1.31.128.147',
              '120.76.116.131', '36.248.210.102', '47.106.62.21', '221.194.147.201', '52.74.244.230', '120.79.181.28',
              '120.24.172.143', '47.106.116.114', '47.107.16.118', '180.163.149.242', '221.194.146.246',
              '139.9.189.208',
              '47.107.18.98', '120.76.64.106', '118.212.236.227', '47.106.14.22', '47.115.182.109', '120.79.193.190',
              '47.107.17.208', '36.249.67.101', '47.106.166.221', '112.74.138.28', '120.79.202.141', '139.159.225.206',
              '58.218.203.233', '120.78.124.201', '36.102.11.241', '120.77.229.20', '139.9.95.45', '39.108.118.105',
              '39.108.188.29', '47.106.184.21', '36.249.76.240', '18.136.50.181', '39.108.42.244', '58.241.27.239',
              '39.108.197.102', '8.135.120.84', '119.23.87.120', '1.180.12.242', '121.37.230.188', '39.108.8.160',
              '47.107.127.116', '42.193.65.239', '120.78.170.186', '13.250.76.48', '47.107.25.230', '47.107.193.22',
              '49.7.22.219', '113.96.109.96', '103.68.183.152', '120.77.229.32', '8.129.5.60', '120.79.134.86',
              '47.107.35.130',
              '47.107.20.79', '47.112.145.232', '120.25.130.72', '47.115.169.248', '120.79.222.169', '39.108.43.50',
              '111.225.210.242', '47.115.151.7', '120.79.179.119', '124.71.222.66', '120.78.11.240', '119.23.83.235',
              '120.78.191.151', '116.62.233.94', '36.249.67.104', '13.250.187.48', '120.79.216.2', '47.115.189.48',
              '124.71.102.53', '27.221.122.238', '120.25.135.140', '120.79.152.145', '39.108.43.101', '47.115.181.24',
              '39.108.135.165', '180.76.185.115', '124.239.158.226', '47.113.23.242', '47.106.85.217', '47.106.207.250',
              '47.106.94.196', '13.251.187.219', '47.106.45.107', '120.25.150.242', '47.106.15.5', '113.96.109.98',
              '52.76.189.10', '112.95.154.62', '120.77.82.75', '39.108.43.224', '54.207.55.213', '47.113.23.237',
              '120.78.186.135', '3.0.220.217', '18.228.99.123', '47.106.28.136', '120.24.228.74', '47.107.217.199',
              '120.77.229.30', '153.3.235.98', '139.159.247.179', '13.234.80.151', '8.129.62.91', '49.7.22.220',
              '39.108.40.213',
              '47.115.152.164', '47.106.208.221', '47.113.23.252', '120.24.7.201', '47.115.115.149', '39.108.41.143',
              '120.79.82.144', '119.147.70.220', '112.132.33.240', '47.107.25.109', '39.108.228.230', '120.77.164.245',
              '36.248.210.78', '124.71.109.76', '47.112.145.204', '18.141.76.162', '112.74.59.70', '47.107.215.140',
              '120.78.165.23', '139.159.231.156', '119.96.75.228', '39.108.145.179', '125.36.180.243', '139.9.195.234',
              '120.77.164.96', '120.24.237.38', '54.233.134.97', '177.71.159.145', '47.107.18.38', '47.107.109.134',
              '8.135.36.63', '139.9.191.178', '13.232.121.220', '120.77.229.209', '47.115.148.163', '47.107.192.132',
              '139.159.142.236', '27.128.221.236', '120.79.150.68', '47.112.165.228', '111.225.210.243',
              '112.74.90.223',
              '47.112.105.21', '120.78.127.153', '18.229.7.44', '47.113.58.149', '139.9.75.10', '112.74.142.34',
              '139.9.179.165',
              '52.221.135.7', '36.248.210.98', '120.78.193.152', '103.15.99.20', '221.6.157.221', '139.9.81.200',
              '153.99.248.242', '119.23.84.176', '18.136.88.219', '36.102.11.242', '47.106.82.193', '139.9.78.19',
              '211.95.52.116']
    print(len(ipList))
    seg = []
    test(ipList, seg)
    print(len(seg))
    print(seg)
