# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:36

from exploit.service.base import *

'''Docker未授权访问漏洞'''


async def dockerAttack(addr):
    try:
        resp = requests.get(url='http://{}/containers/json'.format(addr))
        statusCode = resp.status_code
        if "HostConfig" in resp.content.decode('utf-8') and statusCode == 200:
            return True, {'name': 'unauth', 'url': addr, 'software': 'Docker'}
        else:
            return False, ''
    except:
        pass
