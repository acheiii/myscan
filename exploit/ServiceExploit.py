# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-09-02 22:30

from tqdm import tqdm

from core.utils.InformationProvider import InformationProvider
from exploit.public import *
from exploit import BaseExploit

from exploit.service.dubbo import dubboScan
from exploit.service.ftp import ftpScan
from exploit.service.jdwp import jdwpScan
from exploit.service.log4j import log4jScan
from exploit.service.memcache import memcacheScan
from exploit.service.mongodb import mongodbScan
from exploit.service.mssql import mssqlScan
from exploit.service.mysql import mysqlScan
from exploit.service.postgresql import postgresqlScan
from exploit.service.rdp import rdpScan
from exploit.service.redis import redisScan
from exploit.service.rmi import rmiScan
from exploit.service.rsync import rsyncScan
from exploit.service.smb import smbScan
from exploit.service.ssh import sshScan
from exploit.service.vnc import vncScan
from exploit.service.zookeeper import zookeeperScan


class PortServiceScan(BaseExploit):

    def __init__(self, domain, portServiceList, pbar):
        super().__init__()
        self.source = 'PortServiceScan'
        self.domain = domain
        self.portServiceList = portServiceList
        self.pbar = pbar

    def scan(self):
        pass

    async def exploit(self):
        #     # self.portServiceList = [
        #     # {'service': 'redis', 'ip': ['1.1.1.1:6379','2.2.2.2:9874']},
        #     # {'service': 'rsync', 'ip': ['3.3.3.3:873','4.4.4.4:783'], }
        #     # ]
        redisPasswordList = InformationProvider.readFile(
            os.path.join(InformationProvider.dictPath, 'redis_passwords.txt'))
        ftpPasswordList = InformationProvider.readFile(
            os.path.join(InformationProvider.dictPath, 'ftp_passwords.txt'))
        mysqlPasswordList = InformationProvider.readFile(
            os.path.join(InformationProvider.dictPath, 'mysql_passwords.txt'))
        smbPasswordList = InformationProvider.readFile(
            os.path.join(InformationProvider.dictPath, 'smb_passwords.txt'))
        mssqlPasswordList = InformationProvider.readFile(
            os.path.join(InformationProvider.dictPath, 'sqlserver_passwords.txt'))

        serviceTaskList = []
        
        for target in self.portServiceList:
            targetService = target['service']
            if 'textui' in targetService:
                # textui == dubbo
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(dubboScan(_, pbar)))
            elif 'ftp' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(ftpScan(_, ftpPasswordList, pbar)))
            elif 'jdwp' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(jdwpScan(_, pbar)))
            elif 'log4j' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(log4jScan(_, pbar)))
            elif 'memcache' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(memcacheScan(_, pbar)))
            elif 'mongodb' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(mongodbScan(_, pbar)))
            elif 'mssql' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(mssqlScan(_, pbar)))
            elif 'mysql' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(mysqlScan(_, pbar)))
            elif 'postgresql' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(postgresqlScan(_, pbar)))
            elif 'rdp' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(rdpScan(_, pbar)))
            elif 'redis' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(redisScan(_, redisPasswordList, pbar)))
            elif 'rmi' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(rmiScan(_, pbar)))
            elif 'smb' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(smbScan(_, pbar)))
            elif 'rsync' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(rsyncScan(_, pbar)))
            elif 'ssh' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(sshScan(_, pbar)))
            elif 'vnc' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(vncScan(_, pbar)))
            elif 'zookeeper' in targetService:
                for _ in target['ip']:
                    serviceTaskList.append(asyncio.create_task(zookeeperScan(_, pbar)))
            elif 'http' in targetService:
                pass
            else:
                pass
        # 数据处理
        result = await asyncio.gather(*serviceTaskList)  # [[{}],[{}]]
        for i in result:
            for j in i:
                self.resList.append(j)
        print(self.resList)
        # self.writeFile(self.resList, 12)

    async def main(self):
        await self.exploit()


if __name__ == '__main__':
    portServiceList = [{'service': 'rmi',
                        'ip': ['47.103.143.5:9999', '45.193.77.134:1099', '113.201.215.105:1099', '113.194.69.99:9999',
                               'https://42.194.230.121:2967', '117.48.120.226:800', '13.75.70.229:7003',
                               '45.193.77.130:1099', '45.193.77.136:1099', '47.103.116.49:1099',
                               'https://m.ysticket.com', '117.48.120.226:587', '40.83.91.226:7003',
                               '110.172.221.92:9999', '119.29.10.14:993', '45.193.18.92:1099', '13.70.62.97:7003',
                               '113.201.214.140:1099', 'https://42.194.230.121:8099', '81.70.218.10:1099',
                               '47.108.59.18:9999', '124.70.23.135:8686', '124.160.177.6:1099', '106.37.74.177:1099',
                               '45.193.18.87:1099', '47.90.77.90:10001', 'https://42.194.226.30:2612',
                               '40.83.91.95:7003', '47.95.234.112:1099', '220.189.209.11:1099', '125.66.90.71:9999',
                               '47.106.97.145:6000', '47.101.43.96:9999', 'https://118.24.151.81',
                               'https://81.71.46.239:995', 'https://119.29.10.14:2455', '52.175.73.227:9000',
                               '45.193.51.119:1099', 'https://42.194.226.30:4089', '45.193.72.139:1099',
                               '106.55.40.191:1099', '118.163.162.27:8686', '45.193.72.134:1099', '39.103.215.47:9999',
                               '183.63.125.84:1099', '45.193.51.117:1099', '45.193.72.138:1099', '211.76.138.11:1099',
                               '45.193.72.131:1099', '45.193.72.136:1099', '45.193.72.133:1099', '159.75.125.176:3280',
                               '45.193.51.116:1099', '159.75.125.176:5901', '45.193.51.118:1099', '45.193.72.132:1099',
                               '45.193.51.122:1099', '45.193.51.124:1099', 'https://106.52.115.145',
                               '101.36.105.97:2948', '13.75.70.229:8081', '101.36.105.97:7171', '123.59.213.5:10162',
                               '45.193.72.140:1099', '23.99.98.107:8088', '39.105.105.199:1099', '42.194.226.30:7001',
                               '47.97.103.128:1099', '113.108.247.62:1099', 'https://43.248.130.120:8080',
                               '120.33.237.109:9999', '47.115.112.253:10001', '115.28.208.211:1099',
                               '23.99.98.107:8008', '118.193.36.155:9000', '42.194.230.121:880', '168.63.203.117:8081',
                               '47.105.213.202:1099', '117.48.120.226:902', '110.172.221.99:9999',
                               '52.175.122.194:2628', '45.193.73.150:1099', '159.75.125.176:3352', '45.193.73.155:1099',
                               '45.193.73.156:1099', 'https://123.207.23.211:2484', '124.89.104.43:1099',
                               '121.43.147.128:1099', '13.94.1.39:8080', '117.48.120.226:2447', '45.193.73.153:1099',
                               'https://42.194.230.121:2484', '13.75.91.216:8092', 'https://42.194.230.121:2483',
                               '42.194.226.30:6000', '47.111.96.116:1099', '113.201.61.88:1099', '106.75.252.72:1099',
                               '42.194.230.121:6560', '47.101.48.9:1099', '47.99.37.122:1099', '121.37.140.76:1099',
                               '81.71.46.239:5005', '124.89.104.103:1099', '120.78.235.233:6000', '39.97.231.90:1099',
                               '81.71.46.239:26470', '49.232.44.250:1099', 'https://skchedui.com',
                               'https://123.207.23.211:4096', '23.102.229.253:2628', '42.194.230.121:84',
                               '52.175.60.231:83', '123.207.23.211:26470', '121.43.255.28:9999', '42.194.226.30:25105',
                               '45.193.18.90:1099', '39.100.144.115:10001', '13.70.20.44:8082', '117.48.120.226:6565',
                               '118.190.149.185:10001', '175.24.98.177:1099', '123.176.102.134:9999',
                               '117.48.120.226:777', 'https://23.101.5.202:8443', '120.77.156.129:1099',
                               '121.4.161.24:1099', 'www.shhanjia.com', '182.254.136.26:7676', '117.48.120.226:60001',
                               '123.207.23.211:12300', '58.252.131.253:9999', '23.99.107.146:83', '115.28.171.83:1099',
                               '139.196.210.141:9999', '117.48.120.226:6488', '42.194.230.121:14265',
                               'https://42.194.226.30:4224', 'https://123.207.23.211:3899', '118.25.21.82:1099',
                               '117.48.120.226:7443', 'https://13.75.117.106:1080', '14.204.149.227:1099',
                               '94.191.5.42:9999', 'https://www.ilfone.com', 'https://ilfone.com',
                               'https://47.92.104.244', '125.227.147.56:1099', '23.99.98.107:8082',
                               'https://23.102.229.253:1080', '120.224.10.35:10001', '23.101.11.52:2628',
                               '117.48.120.226:5051', '106.75.71.81:4111', '13.75.115.142:88',
                               'https://106.52.115.145:4224', '101.36.105.97:4000', '123.59.213.82:1099',
                               'https://123.207.23.211:1515', '42.194.230.121:6699', 'https://106.52.115.145:2369',
                               '101.36.105.97:1311', '45.193.27.139:1099', 'https://13.70.28.99:8443',
                               '52.229.186.233:84', '47.99.176.19:1099', '212.64.68.45:1099', '45.193.27.138:1099',
                               '210.30.64.62:9999', '45.193.27.131:1099', '45.193.27.133:1099', '45.193.28.7:1099',
                               '45.193.28.9:1099', 'https://119.29.10.14:1344', '45.193.27.132:1099',
                               '120.76.221.115:1099', '45.193.28.11:1099', '49.233.170.89:1099',
                               'https://52.184.16.212', '45.193.37.6:1099', '123.59.213.25:1099', '45.193.28.14:1099',
                               '120.26.122.216:1099', '45.193.28.5:1099', '45.193.27.140:1099', '115.231.174.235:10162',
                               '40.83.123.1:82', '123.59.213.79:1099', '13.75.117.106:8008', 'https://13.70.0.76:2000',
                               '42.194.226.30:1024', 'https://81.71.46.239:5001', '47.106.154.121:1099',
                               'https://23.99.111.219:1080', '40.83.94.169:8082', '52.184.16.212:9000',
                               '159.75.125.176:55442', '13.75.80.202:82', 'https://52.184.36.191:1080',
                               '42.192.11.177:1099', '47.116.141.150:9999', 'https://13.75.70.229',
                               '119.23.161.31:1099', '82.157.215.22:1099', '101.36.105.97:2302', '42.194.230.121:801',
                               '47.97.17.33:9999', '47.96.250.182:1099', 'https://42.194.226.30:2219',
                               '117.48.120.226:7777', 'k8s.withubtraining.org', 'https://k8s.withubtraining.org',
                               '52.184.17.71:9000', 'https://42.194.226.30:50100', 'https://123.207.23.211:2948',
                               '218.108.202.34:1099', '183.131.247.78:1099', 'www.sikun.site', '106.52.115.145:6998',
                               'https://106.13.248.78', '13.75.70.229:8005', '39.106.84.251:1099',
                               '218.108.202.42:1099', '218.108.202.18:1099', 'https://106.13.248.19',
                               '106.75.71.81:49153', 'https://blog.irene.ink', '123.207.23.211:8098',
                               'https://101.132.226.122', '60.249.113.203:1099', 'https://1.117.74.21',
                               '106.75.71.81:8139', 'https://171.107.184.240', '106.75.71.81:4430',
                               '114.115.232.240:1099', '159.75.125.176:8377', 'https://119.29.10.14:554',
                               '118.178.56.76:1099', '101.36.105.97:9944', '42.194.230.121:7500', '117.78.39.208:1099',
                               '13.75.117.106:8092', '106.75.71.81:9083', '13.70.0.76:82', '111.231.85.46:1099',
                               '121.40.241.203:1099', '40.83.115.69:8008', 'https://81.71.46.239:199',
                               '117.48.120.226:3785', '180.142.104.93:1099', '58.215.188.14:9999',
                               'https://40.83.91.95', 'https://40.83.91.226', 'https://81.71.46.239:8081',
                               'https://116.62.20.13', 'https://123.207.23.211:1059', '45.193.38.184:1099',
                               'https://42.194.230.121:6522', '42.194.226.30:49151', '42.194.230.121:8086',
                               '13.72.208.216:83', '106.46.113.68:1099', '121.40.125.212:9999', '61.132.227.36:1099',
                               '139.196.87.241:9999', '47.106.251.47:1099', '45.193.38.180:1099',
                               'https://13.75.108.57:1080', '47.105.122.63:10001', '106.75.71.81:445',
                               'https://www.daimafans.com', '118.144.66.250:8686', '42.194.230.121:9090',
                               '52.229.200.45:9000', '118.144.66.240:8686', '106.75.71.81:4096', '39.104.165.37:9999',
                               '118.144.66.251:8686', '49.4.14.233:10001', '40.83.77.11:8083', '45.193.64.75:1099',
                               'https://42.194.230.121:8834', '119.29.10.14:16010', '39.107.92.42:9999',
                               '120.26.88.141:9999', '137.116.160.188:88', '180.163.192.223:1099',
                               '106.15.124.200:9999', '122.9.105.30:10001', 'tech.idcquan.com',
                               'https://81.71.46.239:2121', '106.52.115.145:4711', '40.83.124.84:84',
                               '221.179.193.23:9999', 'https://106.52.115.145:4894', '39.96.76.93:9999',
                               '117.48.120.226:9943', 'https://60.250.59.25', 'https://42.194.226.30:3396',
                               'https://81.71.46.239:50000', '124.193.123.204:1099', '221.179.193.22:9999',
                               '119.61.11.221:9999', '81.71.46.239:51106', '106.75.71.81:2455', '192.197.113.160:1099',
                               '114.55.9.72:1099', '47.111.15.36:1099', '101.200.143.188:9999', '23.101.5.202:7003',
                               '101.36.105.97:8378', '45.193.41.110:1099', '45.193.41.108:1099', '45.193.41.107:1099',
                               '119.61.11.216:9999', 'https://106.52.115.145:13', '45.193.41.105:1099',
                               '40.83.117.98:8083', '103.75.105.164:1099', '211.142.166.6:1099', '14.197.160.85:9999',
                               '45.193.41.100:1099', '123.56.71.101:1099', '39.104.60.17:9999', '140.115.2.121',
                               '121.40.78.15:8686', '115.159.101.239:9999', '39.107.141.8:9999', '36.134.194.136:1099',
                               '58.222.103.242:1099', '1.14.73.108:10001', '123.164.253.86:1099', '211.94.218.253:9999',
                               'https://www.amaoon.cn', '13.70.62.97:8005', 'www.eiccorg.com', '58.87.86.187:9999',
                               '121.11.18.226:1099', '101.200.132.159:1099', '52.229.155.145:8005',
                               '180.169.217.4:1099', '52.184.16.212:84', '61.189.170.46:3003', '47.97.39.80:4000',
                               '106.75.71.81:6664', '61.137.169.201:1099', '81.71.46.239:5009', '52.184.14.60:83',
                               'https://42.194.226.30:587', '123.207.23.211:32400', '106.75.71.81:2002',
                               '49.235.114.104:1099', '101.36.105.97:2593', '47.106.207.148:1099', '101.36.105.97:7634',
                               '123.139.148.15:1099', '123.139.148.40:1099', '101.36.105.97:4672', '101.36.105.97:3052',
                               'https://www.rmitchina.cn', '218.201.121.101:1099', 'https://42.194.226.30:4226',
                               '42.194.226.30:55553', '101.36.105.97:264', 'https://42.194.230.121:2020',
                               '106.75.71.81:7000', '101.36.105.97:179', 'https://121.4.184.112', '119.3.47.25:1099',
                               'https://159.75.125.176:11', '106.75.71.81:1505', '52.175.123.194:8080',
                               '111.229.166.242:1099', 'https://106.52.115.145:2598', '42.194.230.121:1311',
                               '42.194.226.30:1588', '47.96.134.0:9999', '106.75.175.110:1099', '42.194.226.30:5678',
                               '123.59.211.167:6488', '123.207.23.211:37215', '202.98.251.43:1099',
                               '106.55.26.156:1099', '42.194.230.121:37215', '221.194.153.249:1099',
                               '42.194.230.121:49151', '39.101.212.92:1099', '114.67.92.114:9999', '116.62.7.49:1099',
                               '23.99.121.145:8080', '123.207.23.211:1471', '106.15.138.226:9999', '120.55.62.163:1099',
                               '106.75.71.81:1741', 'https://148.70.112.254', 'https://13.72.198.28:1080',
                               '42.192.17.54:1099', '114.67.92.113:9999', '42.194.230.121:2948', '159.75.125.176:8182',
                               '42.194.230.121:6565', '120.24.151.169:1099', '81.71.42.92:1099', '182.92.170.18:8686',
                               '45.193.55.227:1099', '27.151.33.15:1099', '175.24.70.252:1099', '117.48.120.226:1290',
                               '45.193.55.226:1099', '45.193.55.235:1099', '117.48.120.226:8686', '47.96.166.186:1099',
                               '101.36.105.97:6664', '59.110.153.60:1099', '220.113.215.94:1099', '101.36.105.97:2219',
                               '45.193.55.233:1099', '42.194.226.30:5555', '45.193.55.237:1099', '45.193.55.232:1099',
                               'https://123.207.23.211:2305', '211.87.160.85:1099', '123.207.23.211:8884',
                               '45.193.64.74:1099', '45.193.64.77:1099', '140.246.3.2:10001', '14.29.222.7:1099',
                               '106.55.50.79:1099', 'code2sec.com', 'www.code2sec.com', 'rui0.cn',
                               'https://116.62.194.188', '115.159.30.48:1099', '175.6.132.22:6000',
                               'https://159.75.125.176:9443', 'https://47.107.190.217', '120.77.83.13:1099',
                               'https://42.194.230.121:2447', '36.133.68.166:1099', '111.231.88.164:10001',
                               'https://106.52.115.145:5038', '218.60.53.7:1099', '115.231.130.157:1099',
                               '115.231.130.145:1099', '223.27.34.186:1099', '39.102.55.167:1099', '36.155.115.36:1099',
                               '120.24.251.161:9999', '182.92.192.149:1099', '39.100.56.179:9999', '49.7.40.116:9999',
                               '13.75.117.106:8081', 'https://119.29.10.14:6666', 'https://81.68.151.187',
                               '106.75.71.81:1494', '221.193.213.169:1099', '49.7.40.117:9999', '49.7.40.118:9999',
                               'https://42.194.226.30:3300', '121.41.89.44:1099', '123.59.213.136:6488',
                               'https://23.99.107.146', '223.94.35.219:1099', '47.99.105.58:1099',
                               '140.113.167.12:8686', '140.113.167.13:8686', '39.129.9.79:1099', '81.71.46.239:9295',
                               '103.86.64.227:4444', '106.75.71.81:14147', '180.97.4.6:1099', '58.99.0.174:8686',
                               '112.125.25.19:1099', '103.26.92.138:9999', '117.48.120.226:27017',
                               '140.135.201.67:1099', '159.75.125.176:8140', '116.63.192.58:1099',
                               '101.132.73.205:1099', '140.135.5.72:1099', 'https://13.70.28.99:2000',
                               '222.128.20.160:1099', '211.87.160.84:1099', 'https://42.194.226.30:9001',
                               '58.99.32.133:8686', '168.63.203.117:8006', '163.27.230.82:8686', '106.52.115.145:3001',
                               'https://103.100.159.69', '121.199.49.65:8686', 'https://123.207.23.211:6066',
                               '13.75.91.216:88', '202.96.98.106:8686', '139.9.131.105:1099', '115.227.48.132:1099',
                               '114.236.137.77:1099', '106.104.115.47:8686', '123.59.213.102:1099', '40.83.123.1:9000',
                               '210.22.154.138:1099', '159.75.125.176:84', 'https://119.29.10.14:587',
                               '42.194.226.30:1025', '123.59.213.136:1099', '123.59.213.77:1099', '123.59.213.72:1099',
                               '123.207.23.211:10250', '124.239.140.98:10162', 'https://42.194.230.121:6543',
                               '47.105.92.195:1099', '115.28.99.90:10001', 'https://106.52.115.145:2083',
                               '220.134.124.230:8686', '124.89.28.166:1099', '218.27.147.179:1099',
                               '223.99.161.90:1099', '123.59.213.85:1099', '111.38.155.231:1099', '61.238.150.49:8686',
                               'https://123.207.23.211', 'life.5224440.com', '123.59.213.24:1099',
                               '123.207.23.211:7001', '45.193.17.244:1099', '124.89.28.184:1099',
                               'https://52.175.49.210:2000', '192.144.186.235:8686', 'https://81.71.46.239:5269',
                               '111.53.121.84:1099', 'open.6tlk.com', 'https://106.52.115.145:30303',
                               '124.89.28.155:1099', '139.224.208.105:1099', '121.196.185.80:9999',
                               '42.194.226.30:3005', '106.53.84.50:1099', '27.50.142.21:1099', '42.194.230.121:7002',
                               '182.61.57.77:10001', '115.231.130.152:1099', '61.63.77.123:1099', '61.63.77.121:1099',
                               '123.123.117.130:1099', '45.193.62.121:1099', '183.17.236.219:1099', '42.194.226.30:800',
                               '45.193.62.123:1099', '218.161.65.138:8686', '203.135.135.167:8686',
                               '106.15.103.207:9999', '124.71.109.250:1099', '1.15.144.243:10001',
                               '121.36.192.114:9999', '123.207.23.211:6103', '52.184.16.212:8081',
                               '203.135.135.174:8686', '114.115.217.93:1099', '124.112.49.227:1099',
                               '13.75.108.57:8092', '40.83.116.112:83', 'https://13.70.20.44:8443', '13.75.91.216:83',
                               '47.97.248.142:9999', '40.83.117.98:83', '58.99.33.40:8686',
                               'https://159.75.125.176:9333', '42.200.64.221:8686', '159.75.125.176:631',
                               'https://42.194.230.121:1494', '61.58.156.166:8686', '210.61.2.142:8686',
                               '106.75.71.81:7025', '106.55.173.175:6000', '58.99.32.136:8686', '114.215.186.175:8686',
                               '58.99.33.3:8686', '13.75.117.106:2628', '125.227.174.3:1099', '123.207.23.211:1025',
                               '221.12.133.101:1099', '203.156.216.18:1099', '140.123.22.3:8686', '23.99.101.188:83',
                               '122.116.39.152:9999', '60.212.41.202:1099', '58.99.33.25:8686', '101.91.196.39:1099',
                               '101.132.150.47:1099', '119.45.101.68:5050', '114.30.46.124:9999', '117.48.120.226:1000',
                               '119.29.10.14:51106', '140.123.22.85:8686', '106.52.115.145:6006',
                               '122.116.125.182:9999', '47.100.82.33:9999', '192.192.227.202:9999',
                               '47.111.112.231:9999', '159.75.125.176:8983', '112.104.27.156:8686',
                               '159.75.125.176:2086', '103.254.209.172:8686', '103.227.90.9:9999', '106.52.243.17:1099',
                               '183.6.147.206:9999', '175.47.237.186:1099', 'https://81.71.46.239:64738',
                               '223.240.112.103:1099', '40.83.91.226:9000', '61.222.143.62:8686', '125.228.95.176:8686',
                               '40.83.113.43:83', '42.194.226.30:777', '129.28.194.197:1099', '124.71.23.69:1099',
                               '140.117.165.136:1099', '120.92.209.11:1099', '42.194.226.30:55555', '47.99.33.61:1099',
                               '23.101.11.52:84', '103.254.209.26:9999', '39.129.224.21:9999', '139.224.26.169:1099',
                               'https://123.207.23.211:873', '118.190.23.213:1099', '42.194.230.121:9300',
                               '123.59.213.79:6488', '123.59.213.85:6488', '123.207.23.211:880', '120.55.162.241:1099',
                               '123.59.213.25:6488', '101.36.105.97:32400', '117.48.120.226:7071',
                               'https://42.194.230.121:2220', '106.52.115.145:50090', '221.3.220.150:1099',
                               '123.59.211.190:6488', '123.59.211.213:6488', '123.59.211.248:6488',
                               '123.59.211.177:6488', 'https://42.194.230.121:2735', '123.59.211.174:6488',
                               '123.59.211.192:6488', '123.59.211.229:6488', '123.59.211.180:6488',
                               '123.59.211.205:6488', '47.98.51.170:8090', 'https://blog.lovejinge.com',
                               '123.59.211.153:6488', '121.40.47.42:1099', '47.96.69.26:9999', '139.224.65.44:1099',
                               '47.115.40.254:1099', '119.164.227.6:1099', 'https://106.52.115.145:2200',
                               '120.194.234.100:1099', '115.29.204.28:1099', '23.101.1.141:9000', '106.52.115.145:5555',
                               'https://42.194.230.121:1270', '210.200.142.51:9999', '140.117.165.129:1099',
                               '123.59.211.131:6488', '113.201.164.118:1099', '115.159.160.208:7676',
                               '45.193.26.211:1099', '113.200.37.47:1099', '1.117.219.52:1099', '45.193.26.220:1099',
                               '122.51.194.161:1099', '120.27.30.241:8180', 'https://www.beyondspider.com',
                               '47.89.17.225:6488', '139.129.217.170:1099', '183.129.148.83:1099',
                               '117.48.120.226:5258', '182.92.85.112:1099', '101.132.76.21:1099', '106.75.71.81:49151',
                               '222.170.73.46:1099', '123.59.213.72:6488', '59.124.174.142:1099',
                               'https://123.207.23.211:4111', '123.59.213.5:6488', '140.249.50.141:1099',
                               '42.194.226.30:6581', '220.128.243.94:9999', '49.234.221.152:1099', '211.91.56.2:1099',
                               '39.97.254.25:1099', '220.130.119.93:9999', '210.87.250.63:9999', '125.62.27.53:9999',
                               '45.193.26.213:1099', '45.193.26.216:1099', '13.94.16.118:9000', '45.193.26.215:1099',
                               '40.83.100.130:9000', 'https://portal.tyrc.edu.tw', '122.146.7.222:1099',
                               '222.215.23.182:1099', '218.77.128.199:9999', 'https://123.207.23.211:7306',
                               '59.125.94.51:9999', '59.125.50.75:9999', '115.236.169.171:9999', '59.125.124.197:9999',
                               '120.25.193.56:1099', 'https://159.75.125.176:49', '116.63.183.99:1099',
                               '45.193.26.218:1099', '45.193.26.210:1099', '60.199.209.84:9999', '45.193.26.212:1099',
                               '60.199.129.102:9999', '140.125.84.88:9999', 'https://159.75.125.176:873',
                               '60.199.209.116:9999', '60.199.209.118:9999', '42.194.230.121:5984', '59.125.94.50:9999',
                               '101.132.227.135:1099', '45.193.26.214:1099', '52.175.123.194:83', '223.100.49.198:1099',
                               '61.31.226.57:9999', '40.73.123.52:9999', '61.31.226.61:9999', '40.73.123.51:9999',
                               '40.73.123.49:9999', '60.199.129.101:9999', '101.204.60.231:1099', '120.110.115.96:9999',
                               '60.251.157.50:9999', '47.103.143.31:6000', '210.87.250.64:9999', '61.50.105.170:9999',
                               '124.71.213.41:1099', '106.75.71.81:19150', '220.130.119.92:9999', '117.48.120.226:2083',
                               '47.93.34.88:1099', '125.227.168.67:1099', 'solo.somecat.top',
                               'https://159.75.125.176:2401', '101.133.219.70:9999', '121.10.203.31:1099',
                               '120.26.46.163:1099', '59.125.124.196:9999', '117.48.120.226:990', '47.97.1.186:1099',
                               '49.234.149.14:1099', '60.199.209.111:9999', '101.71.132.202:9999',
                               '42.194.230.121:8686', '221.229.200.122:1099', '123.59.211.193:1099',
                               '117.48.120.226:9051', '106.52.115.145:81', '123.56.25.56:8088',
                               'https://42.194.226.30:8010', '61.55.159.151:1099', '60.249.176.6:1099',
                               '221.229.200.132:1099', '123.57.225.201:1099', 'https://81.71.46.239:25565',
                               '117.48.120.226:5006', 'https://42.194.230.121:3025', '123.59.211.213:1099',
                               '40.73.109.3:9999', '221.229.200.130:1099', 'https://159.75.125.176:27017',
                               '106.75.71.81:1962', '221.229.200.125:1099', '221.229.200.121:1099', '106.75.71.81:992',
                               'https://159.75.125.176:10000', '203.86.233.82:9999', '125.62.27.90:9999',
                               '45.193.52.115:1099', '45.193.52.114:1099', 'dearmarcy.chyani.com',
                               '123.59.211.205:1099', 'https://81.71.46.239:20547', '106.52.115.145:880',
                               '203.135.133.7:9999', '203.135.133.5:9999', '122.226.122.246:9999',
                               '101.36.122.186:8088', '111.47.88.153:1099', '106.75.71.81:9446', '221.229.200.124:1099',
                               '123.59.211.229:1099', '221.229.200.123:1099', '45.193.52.120:1099',
                               '123.59.211.248:1099', '120.77.34.106:1099', '123.207.23.211:1234', '60.199.171.18:9999',
                               '221.229.200.131:1099', '119.29.10.14:3689', '42.194.226.30:1935', '42.194.226.30:8200',
                               '119.23.76.231:1099', '39.107.245.114:9999', '13.75.70.229:8089', '220.130.119.95:9999',
                               '118.31.110.34:1099', '220.130.119.91:9999', '203.135.133.18:9999', '121.36.33.195:9999',
                               'https://202.66.80.118', '106.14.78.236:1099', 'https://59.127.108.231',
                               '118.31.10.133:1099', '203.135.133.6:9999', 'https://42.194.230.121:2022',
                               '101.132.143.47:1099', '45.193.1.189:1099', 'https://140.115.2.121',
                               '60.249.148.20:9999', 'https://42.194.230.121:853', '101.200.0.218:1099',
                               'https://42.194.230.121:4007', '116.85.51.96:9999', '58.215.188.3:9999',
                               '212.129.154.249:1099', '203.218.229.91:9999', '47.97.22.100:1099', '40.73.109.2:9999',
                               '40.73.109.4:9999', '45.193.12.66:1099', '40.73.109.0:9999', '40.73.126.114:9999',
                               '39.106.73.105:1099', '60.199.129.103:9999', '140.115.170.245:1099', '45.193.12.67:1099',
                               '47.104.213.189:1099', '13.75.107.63:88', '221.130.203.171:1099', '118.163.19.176:9999',
                               'https://106.52.115.145:7312', '42.194.226.30:8123', '221.10.71.26:9999',
                               '39.106.206.232:1099', 'https://123.207.23.211:3003', '13.75.91.216:7003',
                               'https://13.75.107.135', '39.101.187.20:1099', 'www.rmi.nkfust.edu.tw',
                               '210.244.206.141:9999', 'https://42.194.226.30:2484', '60.199.205.145:9999',
                               '125.62.24.108:9999', 'https://106.52.115.145:7006', '23.101.5.202:8083',
                               '114.215.143.122:1099', '101.133.141.19:9999', '60.174.233.19:1099',
                               'https://123.207.23.211:7670', '159.75.134.34:1099', '40.73.123.50:9999',
                               '40.73.123.48:9999', 'https://119.29.10.14:9002', 'https://120.27.27.208',
                               '111.230.55.233:9999', 'https://13.75.108.57', '119.29.10.14:5984', '45.193.64.67:1099',
                               '23.101.11.52:7003', '211.161.211.221:1099', '13.70.20.44:8088', '123.207.23.211:15000',
                               '123.205.12.94:1099', '40.73.90.244:9999', '13.75.108.57:7003', '103.15.194.14:1099',
                               '123.118.76.146:1099', '202.189.5.55:9999', '211.140.85.167:1099', '202.189.5.57:9999',
                               '202.189.5.56:9999', '202.189.5.54:9999', '101.132.124.15:1099', '103.15.194.12:1099',
                               '118.31.22.28:1099', '117.48.120.226:37215', '103.210.160.73:9999', '125.62.42.33:9999',
                               'https://159.75.125.176:5001', '59.110.173.253:1099', '203.73.24.136:1099',
                               '123.59.211.81:1099', '123.59.211.151:1099', '101.66.249.76:9999', '116.85.60.157:9999',
                               '119.136.32.27:8686', '183.213.19.197:1099', '47.96.78.218:1099', '121.31.68.137:1099',
                               '207.46.130.170:9000', '117.48.120.226:2809', '106.52.115.145:8030',
                               '123.59.211.91:1099', '40.73.109.1:9999', '117.48.120.226:1494', '119.167.151.100:1099',
                               'https://123.207.23.211:50100', '42.194.226.30:5009', '159.75.125.176:50050',
                               '171.8.66.88:1099', '40.83.124.84:8888', '49.233.27.158:8090', '45.193.1.190:1099',
                               'https://www.demonlee.tech', 'https://demonlee.tech', 'https://47.100.223.184',
                               '119.29.10.14:1471', 'https://www.flyingdreamtravel.com', '113.28.55.44:9999',
                               '203.156.246.43:9999', 'hanweiblog.top', '60.199.235.134:9999', '47.96.144.13:4000',
                               '211.75.186.148:1099', '61.145.9.64:1099', '23.101.5.202:82', '13.75.107.135:2628',
                               '123.139.70.224:1099', '123.139.70.190:1099', '101.36.105.97:1029', '13.75.107.63:2628',
                               '45.193.1.184:1099', '119.29.10.14:5802', '45.193.1.180:1099', '106.14.118.125:1099',
                               'https://106.52.115.145:3396', '123.139.70.248:1099', '42.194.226.30:8222',
                               '101.36.116.165:2628', '45.193.1.188:1099', '116.85.44.21:9999', '42.194.230.121:5938',
                               'https://40.83.115.69', '45.193.77.138:1099', '58.33.101.70:9999', '42.194.226.30:49154',
                               '81.71.46.239:9944', '45.193.77.140:1099', '45.193.77.132:1099',
                               'https://42.194.226.30:2948', '45.193.77.133:1099', '59.125.148.36:1099',
                               '42.194.230.121:8334', '60.199.205.155:9999', '52.175.127.169:83',
                               'https://42.194.230.121:1515', '36.170.98.194:9999', '117.48.120.226:1311',
                               '42.194.230.121:2010', '60.248.181.206:1099', '140.249.35.230:1099',
                               '123.59.211.37:1099', '115.85.251.152:1099', '101.36.105.97:8834', '123.59.211.123:1099',
                               '60.247.136.178:3306', '106.52.115.145:32771', '123.139.70.14:1099', '45.193.78.85:1099',
                               '123.139.70.7:1099', 'https://81.71.46.239:5111', '52.175.49.210:84',
                               '123.59.211.71:1099', '118.190.175.77:1099', '124.89.28.228:1099',
                               '123.207.23.211:55553', '183.230.145.164:1099', '45.193.78.88:1099', '45.193.78.84:1099',
                               '121.8.216.164:1099', 'https://42.194.226.30:1494', 'https://www.xiaoqi7.top',
                               'https://175.24.233.61', '45.193.78.82:1099', '42.194.226.30:5003', '45.193.78.83:1099',
                               '45.193.78.86:1099', 'https://150.158.165.192', '120.26.208.27:1099', '150.158.165.192',
                               'https://106.52.115.145:8400', 'https://123.207.23.211:8074',
                               'https://106.52.115.145:3724', '111.172.231.211:1099', '39.105.39.244:1099',
                               '117.48.120.226:31', '159.75.125.176:37215', 'https://81.71.46.239:1723']}]
    total = 0
    for targetService in portServiceList:
        total += len(targetService['ip'])
    pbar = tqdm(total=total, desc="ServiceScan", ncols=150)  # total是总数
    p = PortServiceScan('asd', portServiceList, pbar)
    loop = asyncio.get_event_loop()
    loop.run_until_complete(p.main())

    # starttime = time.time()
    # list_ = ['172.30.212.58']
    # queue = asyncio.Queue(-1)
    # xxx = IpUnauth('nbcc.cn', queue)
    #
    # print(time.time() - starttime)
