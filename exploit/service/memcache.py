# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:34

from exploit.service.base import *


'''Memcache未授权访问漏洞'''
try:
    s = socket.socket()
    s.connect((str(_ip), 11211))
    s.send(b"stats")
    result = s.recv(1024)
    if b"STAT version" in result:
        self.ipunauthlist.append({
            'name': '未授权访问',
            'url': str(_ip) + ':11211',
            '组件': 'Memcache'
        })
except:
    pass

finally:
    s.close()