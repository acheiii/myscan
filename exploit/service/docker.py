# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:36

from Exploit.Service.service import *


'''Docker未授权访问漏洞'''
def do():
    try:
        conn = http.client.HTTPConnection(str(_ip), 2375, True)
        conn.request("GET", '/containers/json')
        resp = conn.getresponse()
        if resp.status == 200 and "HostConfig" in resp.read():
            self.ipunauthlist.append({
                'name': '未授权访问',
                'url': str(_ip) + ':2375/containers/json',
                '组件': 'Docker'
            })

            # with open('result.txt', 'a+')as aaa:
            #     aaa.write('Docker未授权访问漏洞 : ' + str(ip) + ':2375/containers/json' + '\n')
    except:
        pass
    finally:
        conn.close()