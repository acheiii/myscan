# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:34
from Exploit.Service.service import *

'''ZooKeeper未授权访问漏洞'''
try:
    s = socket.socket()
    s.connect((str(_ip), 2181))
    s.send(b"envi")
    result = s.recv(1024)
    if b"zookeeper.version" in result:
        self.ipunauthlist.append({
            'name': '未授权访问',
            'url': str(_ip) + ":2181",
            '组件': 'ZooKeeper'
        })
except:
    pass
finally:
    s.close()