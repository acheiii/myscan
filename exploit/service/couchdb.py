# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:36

from exploit.service.base import *

'''CouchDB未授权访问漏洞'''
async def couchdbAttack(addr):
    vulList = []
    try:
        rr = requests.get(url=str('http://' + str(addr) + '/_config'))
        if "couch" in rr.content:
            vulList.append({
                'name': '未授权访问',
                'url': str(rr.url),
                '组件': 'CouchDB'
            })

            # with open('result.txt', 'a+')as aaa:
            #     aaa.write('CouchDB未授权访问漏洞 : ' + str(rr.url) + '\n')
    except:
        pass