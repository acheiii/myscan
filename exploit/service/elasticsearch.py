# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:34

def do():
    '''Elasticsearch未授权访问漏洞'''
    try:
        conn = http.client.HTTPConnection(str(_ip), 9200, True)
        conn.request("GET", '/_cat/master')
        resp = conn.getresponse()
        if resp.status == 200:
            self.ipunauthlist.append({
                'name': '未授权访问',
                'url': str(_ip) + ':9200',
                '组件': 'Elasticsearch'
            })

    except:
        pass
    finally:
        s.close()