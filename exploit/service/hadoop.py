# coding=utf-8
# @Author   : zpchcbd HG team
# @Time     : 2021-08-27 18:36
from exploit.service.base import *


async def hadoopScan():
    # Hadoop YARN ResourceManager 未授权访问漏洞
    try:
        xxx_ = []
        xxx1 = 'http://' + str(_ip)
        xxx2 = 'http://' + str(_ip) + ':8088'
        xxx_.append(xxx1)
        xxx_.append(xxx2)
        for xx in xxx_:
            url = xx + '/ws/v1/cluster/apps/new-application'
            resp = requests.post(url)
            app_id = resp.json()['application-id']
            if app_id:
                self.ipunauthlist.append({
                    'name': '未授权访问',
                    'url': str(_ip),
                    '组件': 'Hadoop'
                })
    except:
        pass
